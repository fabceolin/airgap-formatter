# Story 2.2: Main Editor UI Layout

## Status: Ready for Review

## Story

**As a** user,
**I want** a split-pane editor interface,
**so that** I can see my input JSON and formatted output side by side.

## Acceptance Criteria

1. Main window with horizontal split: input pane (left) and output pane (right)
2. Input pane contains editable text area with monospace font
3. Output pane contains read-only text area with monospace font
4. Resizable split handle allows adjusting pane proportions
5. Window is responsive: switches to vertical split (top/bottom) below 1200px width
6. Dark theme applied as default with professional color scheme

## Tasks / Subtasks

- [x] Task 1: Create Theme.qml with color definitions (AC: 6)
  - [x] Create `qt/qml/Theme.qml`
  - [x] Define dark theme background colors
  - [x] Define text colors (primary, secondary, error, success)
  - [x] Define border and accent colors
  - [x] Define monospace font family

- [x] Task 2: Create InputPane.qml component (AC: 2)
  - [x] Create `qt/qml/InputPane.qml`
  - [x] Add ScrollView with TextArea
  - [x] Configure monospace font
  - [x] Apply dark theme styling
  - [x] Export text property alias
  - [x] Set placeholder text "Paste or type JSON here..."

- [x] Task 3: Create OutputPane.qml component (AC: 3)
  - [x] Create `qt/qml/OutputPane.qml`
  - [x] Add ScrollView with TextArea (read-only)
  - [x] Configure monospace font
  - [x] Apply dark theme styling
  - [x] Export text property alias
  - [x] Set placeholder text "Formatted output will appear here"

- [x] Task 4: Update Main.qml with split-pane layout (AC: 1, 4)
  - [x] Replace "Hello Airgap" with SplitView
  - [x] Add InputPane as first child
  - [x] Add OutputPane as second child
  - [x] Configure horizontal orientation
  - [x] Style split handle for visibility

- [x] Task 5: Implement responsive layout (AC: 5)
  - [x] Add width change handler
  - [x] Switch to vertical split below 1200px
  - [x] Switch to horizontal split at 1200px and above
  - [x] Maintain content during orientation change

- [x] Task 6: Apply consistent dark theme styling (AC: 6)
  - [x] Import Theme in all QML files
  - [x] Apply background colors
  - [x] Apply text colors
  - [x] Apply border styling
  - [x] Ensure consistent visual appearance

- [x] Task 7: Update CMakeLists.txt with new QML files (AC: 1)
  - [x] Add Theme.qml to QML_FILES
  - [x] Add InputPane.qml to QML_FILES
  - [x] Add OutputPane.qml to QML_FILES

## Dev Notes

### QML File Structure
```
qt/qml/
├── Main.qml          # Main window with SplitView
├── Theme.qml         # NEW: Color and style definitions
├── InputPane.qml     # NEW: Editable input area
└── OutputPane.qml    # NEW: Read-only output area
```

### Theme.qml

```qml
// qt/qml/Theme.qml
pragma Singleton
import QtQuick

QtObject {
    // Background colors
    readonly property color background: "#1e1e1e"
    readonly property color backgroundSecondary: "#252526"
    readonly property color backgroundTertiary: "#2d2d2d"

    // Text colors
    readonly property color textPrimary: "#d4d4d4"
    readonly property color textSecondary: "#808080"
    readonly property color textError: "#f44747"
    readonly property color textSuccess: "#4ec9b0"

    // Accent colors
    readonly property color accent: "#0078d4"
    readonly property color border: "#3c3c3c"
    readonly property color splitHandle: "#505050"

    // Typography
    readonly property string monoFont: "Consolas, Monaco, 'Courier New', monospace"
    readonly property int monoFontSize: 14
}
```

### InputPane.qml

```qml
// qt/qml/InputPane.qml
import QtQuick
import QtQuick.Controls

Rectangle {
    id: inputPane

    property alias text: textArea.text

    color: Theme.backgroundSecondary
    border.color: Theme.border
    border.width: 1

    ScrollView {
        anchors.fill: parent
        anchors.margins: 1

        TextArea {
            id: textArea
            color: Theme.textPrimary
            font.family: Theme.monoFont
            font.pixelSize: Theme.monoFontSize
            placeholderText: "Paste or type JSON here..."
            placeholderTextColor: Theme.textSecondary
            background: Rectangle {
                color: "transparent"
            }
            wrapMode: TextEdit.Wrap
            selectByMouse: true
        }
    }
}
```

### OutputPane.qml

```qml
// qt/qml/OutputPane.qml
import QtQuick
import QtQuick.Controls

Rectangle {
    id: outputPane

    property alias text: textArea.text

    color: Theme.backgroundSecondary
    border.color: Theme.border
    border.width: 1

    ScrollView {
        anchors.fill: parent
        anchors.margins: 1

        TextArea {
            id: textArea
            color: Theme.textPrimary
            font.family: Theme.monoFont
            font.pixelSize: Theme.monoFontSize
            placeholderText: "Formatted output will appear here"
            placeholderTextColor: Theme.textSecondary
            readOnly: true
            background: Rectangle {
                color: "transparent"
            }
            wrapMode: TextEdit.Wrap
            selectByMouse: true
        }
    }
}
```

### Main.qml Split Layout

```qml
// Main.qml (updated)
import QtQuick
import QtQuick.Controls
import QtQuick.Layouts

ApplicationWindow {
    id: window
    visible: true
    width: 1280
    height: 800
    minimumWidth: 1024
    minimumHeight: 600
    title: "Airgap JSON Formatter"
    color: Theme.background

    SplitView {
        id: splitView
        anchors.fill: parent
        orientation: window.width >= 1200 ? Qt.Horizontal : Qt.Vertical

        handle: Rectangle {
            implicitWidth: 6
            implicitHeight: 6
            color: SplitHandle.hovered ? Theme.accent : Theme.splitHandle
        }

        InputPane {
            id: inputPane
            SplitView.preferredWidth: parent.width / 2
            SplitView.minimumWidth: 300
        }

        OutputPane {
            id: outputPane
            SplitView.fillWidth: true
            SplitView.minimumWidth: 300
        }
    }
}
```

### Responsive Breakpoint
- **1200px**: Switch between horizontal (side-by-side) and vertical (top-bottom) layouts
- At narrow widths, vertical stacking provides better usability

### Critical Architecture Rules
- **Zero Network Calls:** Never use fetch, XMLHttpRequest, WebSocket
- **No Persistent Storage:** Never use localStorage, sessionStorage, IndexedDB
- **Theme Singleton:** Import Theme in all QML files for consistent styling

### Testing

**Manual Verification:**
1. Build and serve application
2. Verify split-pane layout displays
3. Test input pane is editable
4. Test output pane is read-only
5. Drag split handle to resize
6. Resize window below 1200px - verify vertical layout
7. Resize window above 1200px - verify horizontal layout
8. Verify dark theme colors are applied

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-01-20 | 1.0 | Initial story creation | Sarah (PO) |

---

## Dev Agent Record

### Agent Model Used
Claude Opus 4.5 (claude-opus-4-5-20251101)

### Debug Log References
None - Qt WASM toolchain not available for runtime testing

### Completion Notes List
- Created Theme.qml singleton with dark theme colors (background, text, accent, border)
- Created InputPane.qml with editable TextArea in ScrollView
- Created OutputPane.qml with read-only TextArea in ScrollView
- Updated Main.qml with SplitView replacing "Hello Airgap" placeholder
- Implemented responsive layout: horizontal split >= 1200px, vertical split < 1200px
- Added styled split handle with hover effect using Theme.accent color
- Updated CMakeLists.txt with new QML files and singleton registration
- Created qmldir file for singleton registration (backup method)

### File List
- qt/qml/Theme.qml (new)
- qt/qml/InputPane.qml (new)
- qt/qml/OutputPane.qml (new)
- qt/qml/qmldir (new)
- qt/qml/Main.qml (modified)
- qt/CMakeLists.txt (modified)

---

## QA Results
*To be filled by QA agent*
